# =============================================================================
# REFERÊNCIA: Docker Compose para Airflow + MinIO (opcional)
# =============================================================================
# Copie este arquivo para docker-compose.yml e preencha as configurações.
# Documentação Airflow: https://airflow.apache.org/docs/apache-airflow/stable/howto/docker-compose/index.html
# Documentação MinIO: https://min.io/docs/minio/container/index.html
# =============================================================================

# version: "3.8"  # opcional em versões recentes do Compose

services:
  # ---------------------------------------------------------------------------
  # Postgres: banco de metadados do Airflow
  # ---------------------------------------------------------------------------
  # postgres:
  #   image: postgres:13
  #   environment:
  #     POSTGRES_USER: airflow
  #     POSTGRES_PASSWORD: airflow
  #     POSTGRES_DB: airflow
  #   volumes:
  #     - postgres_db:/var/lib/postgresql/data
  #   healthcheck: ...

  # ---------------------------------------------------------------------------
  # Airflow: webserver, scheduler (e worker se usar Celery)
  # ---------------------------------------------------------------------------
  # airflow-webserver:
  #   image: apache/airflow:2.7.0  # ou build: context: . dockerfile: Dockerfile
  #   environment:
  #     AIRFLOW__CORE__EXECUTOR: LocalExecutor
  #     AIRFLOW__DATABASE__SQL_ALCHEMY_CONN: postgresql+psycopg2://airflow:airflow@postgres/airflow
  #     AIRFLOW__CORE__LOAD_EXAMPLES: "false"
  #     AIRFLOW_UID: 50000
  #   volumes:
  #     - ../dags:/opt/airflow/dags
  #     - ../plugins:/opt/airflow/plugins
  #     # Opcional: montar datalake local
  #     # - ../datalake:/opt/airflow/datalake
  #   depends_on:
  #     postgres: ...

  # airflow-scheduler:
  #   image: apache/airflow:2.7.0
  #   # ... mesmas env e volumes do webserver
  #   depends_on: ...

  # ---------------------------------------------------------------------------
  # MinIO (opcional): storage S3-compatível para datalake
  # ---------------------------------------------------------------------------
  # minio:
  #   image: minio/minio:latest
  #   command: server /data
  #   environment:
  #     MINIO_ROOT_USER: minioadmin
  #     MINIO_ROOT_PASSWORD: minioadmin
  #   ports:
  #     - "9000:9000"
  #     - "9001:9001"
  #   volumes:
  #     - minio_data:/data

# volumes:
#   postgres_db:
#   minio_data:
